{
  "created_at": "2025-12-26T15:49:13.107058",
  "command": [
    "/home/ito/tvgti_sem_exog_sparse/code/tune_and_run.py",
    "piecewise"
  ],
  "scenario": "piecewise",
  "config": {
    "common": {
      "N": 5,
      "T": 50,
      "sparsity": 0.5,
      "max_weight": 0.5,
      "std_e": 0.05,
      "seed": 3
    },
    "tuning": {
      "tuning_trials": 3,
      "tuning_runs_per_trial": 1,
      "truncation_horizon": 30
    },
    "enabled_methods": [
      "pp"
    ],
    "piecewise": {
      "K": 2
    }
  },
  "tuning_summary": {
    "seed": 4,
    "tuning_trials": 3,
    "tuning_runs_per_trial": 1,
    "truncation_horizon": 30,
    "generator_kwargs": {
      "N": 5,
      "T": 50,
      "sparsity": 0.5,
      "max_weight": 0.5,
      "std_e": 0.05,
      "K": 2,
      "s_type": "random",
      "t_min": 0.5,
      "t_max": 1.0,
      "z_dist": "uniform01"
    },
    "metric": {
      "error_normalization": "offline_solution",
      "offline_lambda_l1": 0.0005525085084833706
    },
    "initial_fallback": {
      "pp": {
        "r": 50,
        "q": 5,
        "rho": 0.001,
        "mu_lambda": 0.05,
        "lambda_S": 0.01
      },
      "pp_sgd": {
        "r": 1,
        "q": 1,
        "rho": 0.001,
        "mu_lambda": 0.05,
        "lambda_S": 0.01
      },
      "pc": {
        "lambda_reg": 0.001,
        "alpha": 0.01,
        "beta": 0.01,
        "gamma": 0.9,
        "P": 1,
        "C": 1
      },
      "co": {
        "beta_co": 0.02
      },
      "sgd": {
        "beta_sgd": 0.0269
      },
      "pg": {
        "lambda_reg": 0.001,
        "step_scale": 1.0,
        "step_size": null,
        "use_fista": true,
        "use_backtracking": false,
        "max_iter": 500,
        "tol": 0.0001
      }
    },
    "search_spaces": {
      "pp": {
        "r": {
          "type": "categorical",
          "choices": [
            10,
            20,
            30,
            40,
            50,
            75,
            100,
            150,
            200
          ]
        },
        "q": {
          "type": "categorical",
          "choices": [
            1,
            2,
            3,
            5,
            8,
            10
          ]
        },
        "rho": {
          "type": "float",
          "low": 1e-06,
          "high": 0.1,
          "log": true
        },
        "mu_lambda": {
          "type": "float",
          "low": 0.01,
          "high": 2.0,
          "log": true
        },
        "lambda_S": {
          "type": "float",
          "low": 1e-06,
          "high": 0.1,
          "log": true
        }
      },
      "pp_sgd": {
        "rho": {
          "type": "float",
          "low": 1e-06,
          "high": 0.1,
          "log": true
        },
        "mu_lambda": {
          "type": "float",
          "low": 0.0001,
          "high": 1.0,
          "log": true
        },
        "lambda_S": {
          "type": "float",
          "low": 1e-06,
          "high": 0.1,
          "log": true
        }
      },
      "pc": {
        "lambda_reg": {
          "type": "float",
          "low": 1e-05,
          "high": 0.01,
          "log": true
        },
        "alpha": {
          "type": "float",
          "low": 1e-06,
          "high": 0.1,
          "log": true
        },
        "beta_pc": {
          "type": "float",
          "low": 1e-06,
          "high": 0.1,
          "log": true
        },
        "gamma": {
          "type": "float",
          "low": 0.85,
          "high": 0.999,
          "log": false
        },
        "P": {
          "type": "int",
          "low": 0,
          "high": 2,
          "log": false,
          "step": 1
        },
        "C": {
          "type": "categorical",
          "choices": [
            1,
            2,
            5
          ]
        }
      },
      "co": {
        "alpha": {
          "type": "float",
          "low": 1e-06,
          "high": 0.1,
          "log": true
        },
        "beta_co": {
          "type": "float",
          "low": 1e-06,
          "high": 0.1,
          "log": true
        },
        "gamma": {
          "type": "float",
          "low": 0.85,
          "high": 0.999,
          "log": false
        },
        "C": {
          "type": "categorical",
          "choices": [
            1,
            2,
            5
          ]
        }
      },
      "sgd": {
        "alpha": {
          "type": "float",
          "low": 1e-06,
          "high": 0.1,
          "log": true
        },
        "beta_sgd": {
          "type": "float",
          "low": 1e-06,
          "high": 0.1,
          "log": true
        }
      },
      "pg": {
        "lambda_reg": {
          "type": "float",
          "low": 1e-05,
          "high": 0.01,
          "log": true
        },
        "step_scale": {
          "type": "float",
          "low": 1e-06,
          "high": 0.1,
          "log": true
        },
        "use_fista": {
          "type": "categorical",
          "choices": [
            true,
            false
          ]
        }
      },
      "offline": {
        "offline_lambda_l1": {
          "type": "float",
          "low": 0.0001,
          "high": 1.0,
          "log": true
        }
      }
    },
    "search_overrides": {},
    "method_results": {
      "pp": {
        "best_params": {
          "r": 20,
          "q": 3,
          "rho": 0.04873350595481607,
          "mu_lambda": 0.19990754411906742,
          "lambda_S": 3.2755497386508754e-06,
          "offline_lambda_l1": 0.0005525085084833706
        },
        "best_value": 0.527007960197863
      }
    },
    "generator_name": "code.data_gen.generate_piecewise_X_with_exog"
  },
  "snapshots": {
    "hyperparam_tuning": "result/251226/exog_sparse_tuning/scripts/hyperparam_tuning.py",
    "tune_and_run": "result/251226/exog_sparse_tuning/scripts/tune_and_run.py",
    "data_gen": "result/251226/exog_sparse_tuning/scripts/data_gen.py",
    "config": "result/251226/exog_sparse_tuning/scripts/config.py"
  },
  "hyperparam_file": "result/251226/exog_sparse_tuning/piecewise_best_hyperparams_20251226_154913.json"
}