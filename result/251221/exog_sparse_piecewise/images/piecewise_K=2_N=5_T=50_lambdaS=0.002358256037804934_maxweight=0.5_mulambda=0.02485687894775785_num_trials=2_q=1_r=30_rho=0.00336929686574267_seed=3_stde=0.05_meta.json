{
  "created_at": "2025-12-21T22:39:11.655519",
  "command": [
    "/home/ito/tvgti_sem_exog_sparse/code/run_piecewise.py",
    "--hyperparam_json",
    "result/251221/exog_sparse_tuning/piecewise_best_hyperparams_20251221_223910.json"
  ],
  "repro": {
    "git": {
      "head": "e0cd4616eddf53d3cf93ba0ccb2fadf2beffeb10",
      "branch": "main",
      "is_dirty": true
    },
    "hyperparam_json_content": {
      "pp": {
        "r": 30,
        "q": 1,
        "rho": 0.00336929686574267,
        "mu_lambda": 0.02485687894775785,
        "lambda_S": 0.002358256037804934
      },
      "pp_sgd": {
        "r": 1,
        "q": 1,
        "rho": 0.001,
        "mu_lambda": 0.05,
        "lambda_S": 0.01
      },
      "pc": {
        "lambda_reg": 0.001,
        "alpha": 0.01,
        "beta": 0.01,
        "gamma": 0.9,
        "P": 1,
        "C": 1
      },
      "co": {
        "beta_co": 0.02
      },
      "sgd": {
        "beta_sgd": 0.0269
      },
      "pg": {
        "lambda_reg": 0.001,
        "step_scale": 1.0,
        "step_size": null,
        "use_fista": true,
        "use_backtracking": false,
        "max_iter": 500,
        "tol": 0.0001
      },
      "offline_lambda_l1": 0.0003451459427078159
    }
  },
  "config": {
    "num_trials": 2,
    "seed_base": 3,
    "trial_seeds": [
      3,
      4
    ],
    "N": 5,
    "T": 50,
    "sparsity": 0.5,
    "max_weight": 0.5,
    "std_e": 0.05,
    "K": 2
  },
  "config_full": {
    "use_test_config": true,
    "config_name": "CONFIG_TEST",
    "config": {
      "methods": {
        "pp": true,
        "pp_sgd": false,
        "pc": false,
        "co": false,
        "sgd": false,
        "pg": false
      },
      "common": {
        "N": 5,
        "T": 50,
        "sparsity": 0.5,
        "max_weight": 0.5,
        "std_e": 0.05,
        "seed": 3
      },
      "piecewise": {
        "K": 2
      },
      "linear": {},
      "data_gen": {
        "s_type": "random",
        "t_min": 0.5,
        "t_max": 1.0,
        "z_dist": "uniform01"
      },
      "tuning": {
        "tuning_trials": 3,
        "tuning_runs_per_trial": 1,
        "truncation_horizon": 30,
        "tuning_seed": 4
      },
      "search_spaces": {
        "pp": {
          "r": {
            "low": 0,
            "high": 0,
            "log": false,
            "type": "categorical",
            "step": null,
            "choices": [
              10,
              20,
              30,
              40,
              50,
              75,
              100,
              150,
              200
            ]
          },
          "q": {
            "low": 0,
            "high": 0,
            "log": false,
            "type": "categorical",
            "step": null,
            "choices": [
              1,
              2,
              3,
              5,
              8,
              10
            ]
          },
          "rho": {
            "low": 1e-06,
            "high": 0.1,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          },
          "mu_lambda": {
            "low": 0.01,
            "high": 2.0,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          },
          "lambda_S": {
            "low": 1e-06,
            "high": 0.1,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          }
        },
        "pp_sgd": {
          "r": {
            "low": 0,
            "high": 0,
            "log": false,
            "type": "categorical",
            "step": null,
            "choices": [
              10,
              20,
              30,
              40,
              50,
              75,
              100,
              150,
              200
            ]
          },
          "q": {
            "low": 0,
            "high": 0,
            "log": false,
            "type": "categorical",
            "step": null,
            "choices": [
              1,
              2,
              3,
              5,
              8,
              10
            ]
          },
          "rho": {
            "low": 1e-06,
            "high": 0.1,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          },
          "mu_lambda": {
            "low": 0.0001,
            "high": 1.0,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          },
          "lambda_S": {
            "low": 1e-06,
            "high": 0.1,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          }
        },
        "pc": {
          "lambda_reg": {
            "low": 1e-05,
            "high": 0.01,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          },
          "alpha": {
            "low": 1e-06,
            "high": 0.1,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          },
          "beta_pc": {
            "low": 1e-06,
            "high": 0.1,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          },
          "gamma": {
            "low": 0.85,
            "high": 0.999,
            "log": false,
            "type": "float",
            "step": null,
            "choices": null
          },
          "P": {
            "low": 0,
            "high": 2,
            "log": false,
            "type": "int",
            "step": 1,
            "choices": null
          },
          "C": {
            "low": 0,
            "high": 0,
            "log": false,
            "type": "categorical",
            "step": null,
            "choices": [
              1,
              2,
              5
            ]
          }
        },
        "co": {
          "alpha": {
            "low": 1e-06,
            "high": 0.1,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          },
          "beta_co": {
            "low": 1e-06,
            "high": 0.1,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          },
          "gamma": {
            "low": 0.85,
            "high": 0.999,
            "log": false,
            "type": "float",
            "step": null,
            "choices": null
          },
          "C": {
            "low": 0,
            "high": 0,
            "log": false,
            "type": "categorical",
            "step": null,
            "choices": [
              1,
              2,
              5
            ]
          }
        },
        "sgd": {
          "alpha": {
            "low": 1e-06,
            "high": 0.1,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          },
          "beta_sgd": {
            "low": 1e-06,
            "high": 0.1,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          }
        },
        "pg": {
          "lambda_reg": {
            "low": 1e-05,
            "high": 0.01,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          },
          "step_scale": {
            "low": 1e-06,
            "high": 0.1,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          },
          "use_fista": {
            "low": 0,
            "high": 0,
            "log": false,
            "type": "categorical",
            "step": null,
            "choices": [
              true,
              false
            ]
          }
        },
        "offline": {
          "offline_lambda_l1": {
            "low": 0.0001,
            "high": 1.0,
            "log": true,
            "type": "float",
            "step": null,
            "choices": null
          }
        }
      },
      "hyperparams": {
        "pp": {
          "r": 50,
          "q": 5,
          "rho": 0.001,
          "mu_lambda": 0.05,
          "lambda_S": 0.01
        },
        "pp_sgd": {
          "r": 1,
          "q": 1,
          "rho": 0.001,
          "mu_lambda": 0.05,
          "lambda_S": 0.01
        },
        "pc": {
          "lambda_reg": 0.001,
          "alpha": 0.01,
          "beta": 0.01,
          "gamma": 0.9,
          "P": 1,
          "C": 1
        },
        "co": {
          "beta_co": 0.02
        },
        "sgd": {
          "beta_sgd": 0.0269
        },
        "pg": {
          "lambda_reg": 0.001,
          "step_scale": 1.0,
          "step_size": null,
          "use_fista": true,
          "use_backtracking": false,
          "max_iter": 500,
          "tol": 0.0001
        }
      },
      "run": {
        "num_trials": 2
      },
      "metric": {
        "error_normalization": "offline_solution",
        "burn_in": 0,
        "divide_by_n2": false
      },
      "comparison": {
        "pc_model": "exog",
        "pc_use_true_T_init": true,
        "pc_T_init_identity_scale": 1.0,
        "pp_init_b0": "ones",
        "pp_lookahead": 0
      },
      "output": {
        "result_root": "result",
        "subdir_piecewise": "exog_sparse_piecewise",
        "subdir_linear": "exog_sparse_linear",
        "subdir_tuning": "exog_sparse_tuning"
      },
      "skip_tuning": false,
      "skip_simulation": false,
      "hyperparam_json": null
    }
  },
  "metric": {
    "error_normalization": "offline_solution",
    "offline_lambda_l1": 0.0003451459427078159,
    "burn_in": 0,
    "burn_in_effective": 0,
    "divide_by_n2": false
  },
  "comparison": {
    "pc_model": "exog",
    "pc_use_true_T_init": true,
    "pc_T_init_identity_scale": 1.0,
    "pp_init_b0": "ones",
    "pp_lookahead": 0,
    "pp_lookahead_effective": 0
  },
  "methods": {
    "pp": {
      "enabled": true,
      "hyperparams": {
        "r": 30,
        "q": 1,
        "rho": 0.00336929686574267,
        "mu_lambda": 0.02485687894775785,
        "lambda_S": 0.002358256037804934
      }
    },
    "pp_sgd": {
      "enabled": false,
      "hyperparams": {
        "r": 1,
        "q": 1,
        "rho": 0.001,
        "mu_lambda": 0.05,
        "lambda_S": 0.01
      }
    },
    "pc": {
      "enabled": false,
      "hyperparams": {
        "lambda_reg": 0.001,
        "alpha": 0.01,
        "beta": 0.01,
        "gamma": 0.9,
        "P": 1,
        "C": 1
      }
    },
    "co": {
      "enabled": false,
      "hyperparams": {
        "lambda_reg": 0.001,
        "alpha": 0.01,
        "beta_co": 0.02,
        "gamma": 0.9,
        "C": 1
      }
    },
    "sgd": {
      "enabled": false,
      "hyperparams": {
        "lambda_reg": 0.001,
        "alpha": 0.01,
        "beta_sgd": 0.0269,
        "C": 1
      }
    },
    "pg": {
      "enabled": false,
      "hyperparams": {
        "lambda_reg": 0.001,
        "step_scale": 1.0,
        "step_size": null,
        "use_fista": true,
        "use_backtracking": false,
        "max_iter": 500,
        "tol": 0.0001
      }
    }
  },
  "generator": {
    "function": "code.data_gen.generate_piecewise_X_with_exog",
    "kwargs": {
      "s_type": "random",
      "t_min": 0.5,
      "t_max": 1.0,
      "z_dist": "uniform01"
    }
  },
  "results": {
    "figure": "piecewise_K=2_N=5_T=50_lambdaS=0.002358256037804934_maxweight=0.5_mulambda=0.02485687894775785_num_trials=2_q=1_r=30_rho=0.00336929686574267_seed=3_stde=0.05.png",
    "figure_path": "result/251221/exog_sparse_piecewise/images/piecewise_K=2_N=5_T=50_lambdaS=0.002358256037804934_maxweight=0.5_mulambda=0.02485687894775785_num_trials=2_q=1_r=30_rho=0.00336929686574267_seed=3_stde=0.05.png",
    "figure_burnin": null,
    "figure_burnin_path": null,
    "summary_means": {
      "full_mean": {
        "pp": 0.3003417294803429,
        "pp_sgd": null,
        "pc": null,
        "co": null,
        "sgd": null,
        "pg": null
      },
      "post_burnin_mean": {
        "pp": 0.3003417294803429,
        "pp_sgd": null,
        "pc": null,
        "co": null,
        "sgd": null,
        "pg": null
      }
    },
    "metrics": {
      "pp": [
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.3461756420081789,
        0.25450722942906356,
        0.25450722942906356,
        0.25450722942906356,
        0.25450722942906356,
        0.25450722942906356,
        0.25450722942906356,
        0.25450722942906356,
        0.25450722942906356,
        0.25450722957133454,
        0.2545072336780579,
        0.25450724748254316,
        0.25450728363857855,
        0.25450735581718725,
        0.2545074481941114,
        0.2545075784605845,
        0.25450775999886655,
        0.2545079775767777,
        0.25450819497396243,
        0.2545084630676655,
        0.2545087377667741,
        0.2545090050104091,
        0.2545092165106705,
        0.25450919094626845,
        0.25450904184556855,
        0.25450862384080297
      ],
      "pp_sgd": null,
      "pc": null,
      "co": null,
      "sgd": null,
      "pg": null
    }
  },
  "snapshots": {
    "run_piecewise": "result/251221/exog_sparse_piecewise/images/scripts/run_piecewise.py",
    "config": "result/251221/exog_sparse_piecewise/images/scripts/config.py",
    "data_gen": "result/251221/exog_sparse_piecewise/images/scripts/data_gen.py",
    "hyperparams_json": "result/251221/exog_sparse_piecewise/images/scripts/piecewise_best_hyperparams_20251221_223910.json"
  },
  "hyperparam_json": "result/251221/exog_sparse_tuning/piecewise_best_hyperparams_20251221_223910.json",
  "result_dir": "result/251221/exog_sparse_piecewise/images"
}